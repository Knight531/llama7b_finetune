/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /usr/local did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/usr/local/nvidia/lib'), PosixPath('/usr/local/nvidia/lib64')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: /usr/local/nvidia/lib:/usr/local/nvidia/lib64 did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('//facdbe-fo1i7dnzdtyp-main'), PosixPath('http'), PosixPath('8888/jobs/facdbe/jobs/fo1i7dnzdtyp')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('tcp'), PosixPath('//10.111.0.1'), PosixPath('443')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('7890'), PosixPath('http'), PosixPath('//alchemist-experience')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('localhost,127.0.0.1,openbayes-server-svc,openbayes-storage-server-svc,10.0.0.0/8')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('facdbe/jobs/fo1i7dnzdtyp')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('/output/.torch')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: WARNING: The following directories listed in your path were found to be non-existent: {PosixPath('//openbayes-server-svc/api/users/facdbe/jobs/fo1i7dnzdtyp'), PosixPath('http')}
  warn(msg)
/output/.pylibs/lib/python3.8/site-packages/bitsandbytes/cuda_setup/main.py:149: UserWarning: Found duplicate ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] files: {PosixPath('/usr/local/cuda/lib64/libcudart.so.11.0'), PosixPath('/usr/local/cuda/lib64/libcudart.so')}.. We'll flip a coin and try one of these, in order to fail forward.
Either way, this might cause trouble in the future:
If you get `CUDA error: invalid device function` errors, the above might be the cause and the solution is to make sure only one ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] in the paths that we search based on your env.
  warn(msg)
The model weights are not tied. Please use the `tie_weights` method before using the `infer_auto_device` function.

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /output/.pylibs/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda111.so
CUDA_SETUP: WARNING! libcudart.so not found in any environmental path. Searching in backup paths...
CUDA SETUP: CUDA runtime path found: /usr/local/cuda/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 111
CUDA SETUP: Loading binary /output/.pylibs/lib/python3.8/site-packages/bitsandbytes/libbitsandbytes_cuda111.so...
Training Alpaca-LoRA model with params:
base_model: decapoda-research/llama-7b-hf
data_path: apacha_train_7000.json
output_dir: ./my_model_7000
batch_size: 128
micro_batch_size: 2
num_epochs: 2
learning_rate: 0.0003
cutoff_len: 256
val_set_size: 200
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs: True
add_eos_token: False
group_by_length: False
wandb_project: 
wandb_run_name: 
wandb_watch: 
wandb_log_model: 
resume_from_checkpoint: False
prompt template: alpaca

Loading checkpoint shards:   0%|                                                                                                              | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   3%|███                                                                                                   | 1/33 [00:00<00:21,  1.51it/s]Loading checkpoint shards:   6%|██████▏                                                                                               | 2/33 [00:01<00:17,  1.73it/s]Loading checkpoint shards:   9%|█████████▎                                                                                            | 3/33 [00:01<00:16,  1.83it/s]Loading checkpoint shards:  12%|████████████▎                                                                                         | 4/33 [00:02<00:14,  1.95it/s]Loading checkpoint shards:  15%|███████████████▍                                                                                      | 5/33 [00:02<00:14,  1.92it/s]Loading checkpoint shards:  18%|██████████████████▌                                                                                   | 6/33 [00:03<00:12,  2.11it/s]Loading checkpoint shards:  21%|█████████████████████▋                                                                                | 7/33 [00:03<00:11,  2.36it/s]Loading checkpoint shards:  24%|████████████████████████▋                                                                             | 8/33 [00:03<00:09,  2.55it/s]Loading checkpoint shards:  27%|███████████████████████████▊                                                                          | 9/33 [00:04<00:08,  2.71it/s]Loading checkpoint shards:  30%|██████████████████████████████▌                                                                      | 10/33 [00:04<00:08,  2.81it/s]Loading checkpoint shards:  33%|█████████████████████████████████▋                                                                   | 11/33 [00:04<00:07,  2.92it/s]Loading checkpoint shards:  36%|████████████████████████████████████▋                                                                | 12/33 [00:04<00:07,  2.98it/s]Loading checkpoint shards:  39%|███████████████████████████████████████▊                                                             | 13/33 [00:05<00:06,  3.02it/s]Loading checkpoint shards:  42%|██████████████████████████████████████████▊                                                          | 14/33 [00:05<00:06,  3.06it/s]Loading checkpoint shards:  45%|█████████████████████████████████████████████▉                                                       | 15/33 [00:05<00:05,  3.02it/s]Loading checkpoint shards:  48%|████████████████████████████████████████████████▉                                                    | 16/33 [00:06<00:05,  3.07it/s]Loading checkpoint shards:  52%|████████████████████████████████████████████████████                                                 | 17/33 [00:06<00:05,  3.10it/s]Loading checkpoint shards:  55%|███████████████████████████████████████████████████████                                              | 18/33 [00:06<00:04,  3.12it/s]Loading checkpoint shards:  58%|██████████████████████████████████████████████████████████▏                                          | 19/33 [00:07<00:04,  3.10it/s]Loading checkpoint shards:  61%|█████████████████████████████████████████████████████████████▏                                       | 20/33 [00:07<00:04,  3.10it/s]Loading checkpoint shards:  64%|████████████████████████████████████████████████████████████████▎                                    | 21/33 [00:07<00:03,  3.08it/s]Loading checkpoint shards:  67%|███████████████████████████████████████████████████████████████████▎                                 | 22/33 [00:08<00:03,  3.09it/s]Loading checkpoint shards:  70%|██████████████████████████████████████████████████████████████████████▍                              | 23/33 [00:08<00:03,  3.10it/s]Loading checkpoint shards:  73%|█████████████████████████████████████████████████████████████████████████▍                           | 24/33 [00:08<00:02,  3.11it/s]Loading checkpoint shards:  76%|████████████████████████████████████████████████████████████████████████████▌                        | 25/33 [00:09<00:02,  3.11it/s]Loading checkpoint shards:  79%|███████████████████████████████████████████████████████████████████████████████▌                     | 26/33 [00:09<00:02,  3.10it/s]Loading checkpoint shards:  82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 27/33 [00:09<00:01,  3.10it/s]Loading checkpoint shards:  85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 28/33 [00:10<00:01,  3.10it/s]Loading checkpoint shards:  88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 29/33 [00:10<00:01,  3.10it/s]Loading checkpoint shards:  91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 30/33 [00:10<00:00,  3.10it/s]Loading checkpoint shards:  94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 31/33 [00:11<00:00,  3.11it/s]Loading checkpoint shards:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 32/33 [00:11<00:00,  3.13it/s]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:11<00:00,  2.91it/s]Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:11<00:00,  2.79it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LLaMATokenizer'. 
The class this function is called from is 'LlamaTokenizer'.
/output/.pylibs/lib/python3.8/site-packages/peft/utils/other.py:102: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
Found cached dataset json (/root/.cache/huggingface/datasets/json/default-638b20d46902cace/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
  0%|                                                                                                                                          | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 360.86it/s]
Loading cached split indices for dataset at /root/.cache/huggingface/datasets/json/default-638b20d46902cace/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-3203dbbac7a8c8be.arrow and /root/.cache/huggingface/datasets/json/default-638b20d46902cace/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-09d3d117f5d1d237.arrow
trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06220594176090199
Map:   0%|                                                                                                                           | 0/6800 [00:00<?, ? examples/s]Map:   1%|█                                                                                                                | 62/6800 [00:00<00:11, 607.68 examples/s]Map:   2%|██▍                                                                                                             | 145/6800 [00:00<00:09, 733.99 examples/s]Map:   3%|███▋                                                                                                            | 225/6800 [00:00<00:08, 755.11 examples/s]Map:   5%|█████▏                                                                                                          | 312/6800 [00:00<00:08, 796.16 examples/s]Map:   6%|██████▍                                                                                                         | 392/6800 [00:00<00:08, 791.97 examples/s]Map:   7%|███████▊                                                                                                        | 476/6800 [00:00<00:07, 803.38 examples/s]Map:   9%|█████████▋                                                                                                      | 590/6800 [00:00<00:07, 780.13 examples/s]Map:  10%|███████████▋                                                                                                    | 708/6800 [00:00<00:07, 768.11 examples/s]Map:  12%|█████████████▌                                                                                                  | 820/6800 [00:01<00:07, 758.67 examples/s]Map:  14%|███████████████▍                                                                                                | 936/6800 [00:01<00:07, 760.93 examples/s]Map:  15%|█████████████████                                                                                              | 1044/6800 [00:01<00:08, 711.47 examples/s]Map:  17%|██████████████████▍                                                                                            | 1128/6800 [00:01<00:07, 734.73 examples/s]Map:  18%|███████████████████▊                                                                                           | 1212/6800 [00:01<00:07, 757.27 examples/s]Map:  19%|█████████████████████▏                                                                                         | 1298/6800 [00:01<00:07, 779.59 examples/s]Map:  21%|███████████████████████                                                                                        | 1411/6800 [00:01<00:07, 764.93 examples/s]Map:  22%|████████████████████████▍                                                                                      | 1496/6800 [00:01<00:06, 785.01 examples/s]Map:  23%|█████████████████████████▉                                                                                     | 1587/6800 [00:02<00:06, 816.15 examples/s]Map:  25%|███████████████████████████▎                                                                                   | 1671/6800 [00:02<00:06, 818.79 examples/s]Map:  26%|████████████████████████████▋                                                                                  | 1760/6800 [00:02<00:06, 830.54 examples/s]Map:  28%|██████████████████████████████▌                                                                                | 1874/6800 [00:02<00:06, 800.57 examples/s]Map:  29%|███████████████████████████████▉                                                                               | 1959/6800 [00:02<00:05, 807.46 examples/s]Map:  30%|█████████████████████████████████▎                                                                             | 2041/6800 [00:02<00:06, 704.45 examples/s]Map:  31%|██████████████████████████████████▌                                                                            | 2120/6800 [00:02<00:06, 721.31 examples/s]Map:  32%|████████████████████████████████████                                                                           | 2208/6800 [00:02<00:06, 761.69 examples/s]Map:  34%|█████████████████████████████████████▍                                                                         | 2295/6800 [00:02<00:05, 790.68 examples/s]Map:  35%|██████████████████████████████████████▉                                                                        | 2384/6800 [00:03<00:05, 810.50 examples/s]Map:  36%|████████████████████████████████████████▎                                                                      | 2472/6800 [00:03<00:05, 825.73 examples/s]Map:  38%|██████████████████████████████████████████▎                                                                    | 2591/6800 [00:03<00:05, 809.49 examples/s]Map:  40%|███████████████████████████████████████████▊                                                                   | 2687/6800 [00:03<00:04, 847.90 examples/s]Map:  41%|█████████████████████████████████████████████▋                                                                 | 2802/6800 [00:03<00:04, 814.90 examples/s]Map:  42%|███████████████████████████████████████████████▏                                                               | 2887/6800 [00:03<00:04, 821.67 examples/s]Map:  44%|████████████████████████████████████████████████▉                                                              | 3000/6800 [00:03<00:05, 727.57 examples/s]Map:  45%|██████████████████████████████████████████████████▎                                                            | 3084/6800 [00:03<00:04, 749.76 examples/s]Map:  47%|███████████████████████████████████████████████████▊                                                           | 3173/6800 [00:04<00:04, 782.56 examples/s]Map:  48%|█████████████████████████████████████████████████████▏                                                         | 3259/6800 [00:04<00:04, 798.56 examples/s]Map:  50%|███████████████████████████████████████████████████████▏                                                       | 3384/6800 [00:04<00:04, 807.28 examples/s]Map:  51%|████████████████████████████████████████████████████████▋                                                      | 3470/6800 [00:04<00:04, 815.87 examples/s]Map:  53%|██████████████████████████████████████████████████████████▌                                                    | 3590/6800 [00:04<00:03, 803.95 examples/s]Map:  55%|████████████████████████████████████████████████████████████▌                                                  | 3708/6800 [00:04<00:03, 795.66 examples/s]Map:  56%|██████████████████████████████████████████████████████████████▎                                                | 3817/6800 [00:04<00:03, 765.25 examples/s]Map:  57%|███████████████████████████████████████████████████████████████▋                                               | 3901/6800 [00:05<00:03, 780.02 examples/s]Map:  59%|█████████████████████████████████████████████████████████████████                                              | 3985/6800 [00:05<00:03, 792.33 examples/s]Map:  60%|██████████████████████████████████████████████████████████████████▋                                            | 4083/6800 [00:05<00:03, 716.33 examples/s]Map:  61%|████████████████████████████████████████████████████████████████████                                           | 4171/6800 [00:05<00:03, 752.44 examples/s]Map:  63%|█████████████████████████████████████████████████████████████████████▍                                         | 4256/6800 [00:05<00:03, 776.84 examples/s]Map:  64%|██████████████████████████████████████████████████████████████████████▊                                        | 4337/6800 [00:05<00:03, 782.97 examples/s]Map:  65%|████████████████████████████████████████████████████████████████████████▏                                      | 4426/6800 [00:05<00:02, 809.42 examples/s]Map:  67%|██████████████████████████████████████████████████████████████████████████▏                                    | 4543/6800 [00:05<00:02, 795.38 examples/s]Map:  68%|███████████████████████████████████████████████████████████████████████████▍                                   | 4625/6800 [00:05<00:02, 799.56 examples/s]Map:  69%|████████████████████████████████████████████████████████████████████████████▉                                  | 4711/6800 [00:06<00:02, 812.80 examples/s]Map:  71%|██████████████████████████████████████████████████████████████████████████████▎                                | 4795/6800 [00:06<00:02, 818.52 examples/s]Map:  72%|███████████████████████████████████████████████████████████████████████████████▋                               | 4882/6800 [00:06<00:02, 829.85 examples/s]Map:  74%|█████████████████████████████████████████████████████████████████████████████████▌                             | 5000/6800 [00:06<00:02, 732.77 examples/s]Map:  75%|███████████████████████████████████████████████████████████████████████████████████▍                           | 5110/6800 [00:06<00:02, 723.18 examples/s]Map:  76%|████████████████████████████████████████████████████████████████████████████████████▊                          | 5196/6800 [00:06<00:02, 753.72 examples/s]Map:  78%|██████████████████████████████████████████████████████████████████████████████████████                         | 5275/6800 [00:06<00:02, 760.88 examples/s]Map:  79%|███████████████████████████████████████████████████████████████████████████████████████▌                       | 5364/6800 [00:06<00:01, 791.01 examples/s]Map:  80%|████████████████████████████████████████████████████████████████████████████████████████▉                      | 5445/6800 [00:06<00:01, 788.72 examples/s]Map:  81%|██████████████████████████████████████████████████████████████████████████████████████████▎                    | 5530/6800 [00:07<00:01, 803.84 examples/s]Map:  83%|███████████████████████████████████████████████████████████████████████████████████████████▌                   | 5613/6800 [00:07<00:01, 809.71 examples/s]Map:  84%|████████████████████████████████████████████████████████████████████████████████████████████▉                  | 5696/6800 [00:07<00:01, 813.67 examples/s]Map:  85%|██████████████████████████████████████████████████████████████████████████████████████████████▍                | 5784/6800 [00:07<00:01, 830.15 examples/s]Map:  86%|███████████████████████████████████████████████████████████████████████████████████████████████▊               | 5870/6800 [00:07<00:01, 835.47 examples/s]Map:  88%|█████████████████████████████████████████████████████████████████████████████████████████████████▊             | 5990/6800 [00:07<00:01, 804.08 examples/s]Map:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████▍           | 6090/6800 [00:07<00:00, 743.20 examples/s]Map:  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 6203/6800 [00:07<00:00, 743.78 examples/s]Map:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████        | 6313/6800 [00:08<00:00, 738.23 examples/s]Map:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 6399/6800 [00:08<00:00, 764.01 examples/s]Map:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 6488/6800 [00:08<00:00, 792.20 examples/s]Map:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 6576/6800 [00:08<00:00, 813.79 examples/s]Map:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 6693/6800 [00:08<00:00, 798.03 examples/s]Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6800/6800 [00:08<00:00, 735.89 examples/s]                                                                                                                                                                     Map:   0%|                                                                                                                            | 0/200 [00:00<?, ? examples/s]Map:  42%|████████████████████████████████████████████████▍                                                                 | 85/200 [00:00<00:00, 835.21 examples/s]Map: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 775.16 examples/s]                                                                                                                                                                     wandb: Currently logged in as: facdbe01. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.3
wandb: Run data is saved locally in /output/alpaca-lora/wandb/run-20230611_160638-7fkt23t0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-bee-3
wandb: ⭐️ View project at https://wandb.ai/facdbe01/huggingface
wandb: 🚀 View run at https://wandb.ai/facdbe01/huggingface/runs/7fkt23t0
  0%|                                                                                                                                        | 0/106 [00:00<?, ?it/s]